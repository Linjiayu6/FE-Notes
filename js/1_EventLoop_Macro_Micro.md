
# Event Loop / Micro Event Queue / Macro Event Queue

> [[js] 执行机制 (同步, 异步, 事件循环(宏任务, 微任务))](https://zhuanlan.zhihu.com/p/137802406)

js是单线程, 也就是说只有一个 **主线程执行**
```
不恰当例子有助于理解:

银行就一个柜台, 好多人去排队。
每个人的业务不同, 有人就是交水电费, 办理存款业务的人花费时间多些

如何提高银行的办事儿效率?
```

```
规定, 我们暂定按照处理时间来算优先级
1. 交水电费优先级更高些 (花费10ms)
2. 办理存款业务的人低优先级 (花费1s)
   - 存款10w (花费10s) 
   - 存款1个亿 (花费100s)

按照花费的时间算优先级
- 交水电费 (同步) 直接在主线程运行

- 办理存款业务 另外开个小窗口, 毕竟是VIP大客户, 处理存款

- 存款10w 放到 Micro Event Queue 微任务队列中

- 存款1个亿 放到 Macro Event Queue 宏任务队列中

优先级: 同步任务 > Micro Event Queue 微任务队列 > Macro Event Queue 宏任务队列

事件循环: 一旦发现优先级比自己高的, 要去执行高的, 让出主线程, 等前一个优先级任务空了, 再执行后面的。

```


**如何管理 同步和异步 在主线程的处理逻辑?**
- 答案: Event Loop 事件循环

**执行机制?**
- 同步: 优先级更高在主线程处理掉, 异步只能等同步处理完, 再处理.
  
- 异步: 也分369等, 宏任务和微任务之分.
  微任务: promise.then, process.nextTick
  宏任务: setTimeout, setInterval, axios回调, 正常js逻辑等

- **优先级: 同步 > 异步(微任务) > 异步(宏任务)**

```
- js如何处理 同步 和 异步?
- 什么是事件循环机制? 
- 异步的宏任务和微任务区别?
- 执行流程优先级又是什么?
```